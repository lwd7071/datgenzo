import React, { useState, useEffect } from 'react';
import { BookOpen, CheckCircle, RefreshCw, Home, ChevronRight, Award, Lightbulb, Heart, Play, AlertTriangle } from 'lucide-react';

// --- NG√ÇN H√ÄNG C√ÇU H·ªéI ƒê·∫¶Y ƒê·ª¶ (D·ªØ li·ªáu t·ª´ file MTDC_CH∆Ø∆†NG 1-KƒêA.doc) ---
const fullQuestionBank = [
  // --- CH∆Ø∆†NG 1 ---
  {
    id: 101,
    question: "Theo Lu·∫≠t BVMT 2020, M√¥i tr∆∞·ªùng bao g·ªìm c√°c y·∫øu t·ªë v·∫≠t ch·∫•t ...?...",
    options: ["(1) t·ª± nhi√™n, (2) x√£ h·ªôi", "(1) t·ª± nhi√™n, (2) nh√¢n t·∫°o", "(1) v·∫≠t l√Ω, (2) h√≥a h·ªçc", "(1) h·ªØu h√¨nh, (2) v√¥ h√¨nh"],
    answer: "(1) t·ª± nhi√™n, (2) nh√¢n t·∫°o",
    chapter: 1,
    hint: "Bao g·ªìm c·∫£ c√¢y c·ªëi (t·ª± nhi√™n) v√† nh√† c·ª≠a, c·∫ßu ƒë∆∞·ªùng (nh√¢n t·∫°o)."
  },
  {
    id: 102,
    question: "C√°c th√†nh ph·∫ßn c∆° b·∫£n c·ªßa m√¥i tr∆∞·ªùng l√† g√¨?",
    options: ["Kh√≠ quy·ªÉn, th·∫°ch quy·ªÉn, thu·ª∑ quy·ªÉn, sinh quy·ªÉn", "Kh√≠ quy·ªÉn, ƒë·ªãa quy·ªÉn, sinh quy·ªÉn, v≈© tr·ª•", "ƒê·∫•t, n∆∞·ªõc, kh√¥ng kh√≠, √°nh s√°ng", "T·ª± nhi√™n, x√£ h·ªôi, nh√¢n t·∫°o"],
    answer: "Kh√≠ quy·ªÉn, th·∫°ch quy·ªÉn, thu·ª∑ quy·ªÉn, sinh quy·ªÉn",
    chapter: 1,
    hint: "4 quy·ªÉn: Kh√≠, ƒê·∫•t (Th·∫°ch), N∆∞·ªõc (Th·ªßy), S·ª± s·ªëng (Sinh)."
  },
  {
    id: 103,
    question: "S·∫Øp x·∫øp theo th·ª© t·ª± gi·∫£m d·∫ßn h√†m l∆∞·ª£ng c√°c kh√≠ ch·ªß y·∫øu c√≥ trong kh√≠ quy·ªÉn:",
    options: ["Oxy > Nit∆° > Argon > CO2", "Nit∆° > Oxy > Argon > Carbon Dioxide", "Argon > Nit∆° > CO2 > Oxy", "Nit∆° > Oxy > CO2 > Argon"],
    answer: "Nit∆° > Oxy > Argon > Carbon Dioxide",
    chapter: 1,
    hint: "Nit∆° chi·∫øm kho·∫£ng 78%, Oxy kho·∫£ng 21%."
  },
  {
    id: 104,
    question: "T·∫ßng kh√≠ quy·ªÉn n√†o t·∫≠p trung h·∫ßu h·∫øt h∆°i n∆∞·ªõc v√† ph√°t tri·ªÉn c√°c hi·ªán t∆∞·ª£ng th·ªùi ti·∫øt?",
    options: ["T·∫ßng b√¨nh l∆∞u", "T·∫ßng ƒë·ªëi l∆∞u", "T·∫ßng trung l∆∞u", "T·∫ßng nhi·ªát"],
    answer: "T·∫ßng ƒë·ªëi l∆∞u",
    chapter: 1,
    hint: "T·∫ßng th·∫•p nh·∫•t, n∆°i ch√∫ng ta ƒëang s·ªëng."
  },
  {
    id: 105,
    question: "L·ªõp ozone (b·∫£o v·ªá con ng∆∞·ªùi kh·ªèi tia c·ª±c t√≠m) ph√¢n b·ªë ·ªü t·∫ßng n√†o?",
    options: ["T·∫ßng ƒë·ªëi l∆∞u", "T·∫ßng b√¨nh l∆∞u", "T·∫ßng trung l∆∞u", "T·∫ßng ngo√†i"],
    answer: "T·∫ßng b√¨nh l∆∞u",
    chapter: 1,
    hint: "N·∫±m ngay tr√™n t·∫ßng ƒë·ªëi l∆∞u."
  },
  {
    id: 106,
    question: "T·∫ßng kh√≠ quy·ªÉn n√†o l·∫°nh nh·∫•t (c√≥ th·ªÉ xu·ªëng -120 ƒë·ªô C)?",
    options: ["T·∫ßng ƒë·ªëi l∆∞u", "T·∫ßng b√¨nh l∆∞u", "T·∫ßng trung l∆∞u", "T·∫ßng nhi·ªát"],
    answer: "T·∫ßng trung l∆∞u",
    chapter: 1,
    hint: "N·∫±m gi·ªØa t·∫ßng b√¨nh l∆∞u v√† t·∫ßng nhi·ªát."
  },
  {
    id: 107,
    question: "Th·∫°ch quy·ªÉn bao g·ªìm:",
    options: ["V·ªè Tr√°i ƒê·∫•t v√† nh√¢n Tr√°i ƒê·∫•t", "V·ªè Tr√°i ƒê·∫•t v√† l·ªõp manti tr√™n", "L·ªõp ph·ªß v√† nh√¢n", "ƒê·∫•t v√† ƒë√°"],
    answer: "V·ªè Tr√°i ƒê·∫•t v√† l·ªõp manti tr√™n",
    chapter: 1,
    hint: "Ph·∫ßn c·ª©ng ngo√†i c√πng c·ªßa Tr√°i ƒê·∫•t."
  },
  {
    id: 108,
    question: "Sinh quy·ªÉn bao g·ªìm c√°c c∆° th·ªÉ s·ªëng t·ªìn t·∫°i trong c√°c m√¥i tr∆∞·ªùng n√†o?",
    options: ["Th·∫°ch quy·ªÉn, Th·ªßy quy·ªÉn, Kh√≠ quy·ªÉn", "ƒê·∫•t, N∆∞·ªõc, Ch√¢n kh√¥ng", "R·ª´ng, Bi·ªÉn, ƒê·ªìng b·∫±ng", "T·ª± nhi√™n, X√£ h·ªôi"],
    answer: "Th·∫°ch quy·ªÉn, Th·ªßy quy·ªÉn, Kh√≠ quy·ªÉn",
    chapter: 1,
    hint: "S·ª± s·ªëng c√≥ m·∫∑t ·ªü trong ƒë·∫•t, trong n∆∞·ªõc v√† trong kh√¥ng kh√≠."
  },
  {
    id: 109,
    question: "Ch·ª©c nƒÉng n√†o c·ªßa m√¥i tr∆∞·ªùng c√≤n g·ªçi laÃÄ nhoÃÅm ch∆∞ÃÅc naÃÜng saÃân xu√¢ÃÅt t∆∞Ã£ nhieÃÇn?",
    options: ["Kh√¥ng gian s·ªëng", "N∆°i cung c·∫•p t√†i nguy√™n", "N∆°i ch·ª©a ƒë·ª±ng ch·∫•t th·∫£i", "N∆°i l∆∞u tr·ªØ th√¥ng tin"],
    answer: "N∆°i cung c·∫•p t√†i nguy√™n",
    chapter: 1,
    hint: "Cung c·∫•p r·ª´ng, kho√°ng s·∫£n, nƒÉng l∆∞·ª£ng..."
  },
  {
    id: 110,
    question: "M√¥i tr∆∞·ªùng l√† n∆°i l∆∞u tr·ªØ l·ªãch s·ª≠ ƒë·ªãa ch·∫•t, ngu·ªìn gen, vƒÉn h√≥a... minh h·ªça cho ch·ª©c nƒÉng n√†o?",
    options: ["N∆°i ch·ª©a ƒë·ª±ng ch·∫•t th·∫£i", "N∆°i gi·∫£m nh·∫π t√°c ƒë·ªông thi√™n nhi√™n", "N∆°i l∆∞u tr·ªØ v√† cung c·∫•p th√¥ng tin", "Kh√¥ng gian s·ªëng"],
    answer: "N∆°i l∆∞u tr·ªØ v√† cung c·∫•p th√¥ng tin",
    chapter: 1,
    hint: "Li√™n quan ƒë·∫øn vi·ªác 'ghi nh·ªõ' d·ªØ li·ªáu c·ªßa Tr√°i ƒê·∫•t."
  },

  // --- CH∆Ø∆†NG 2 ---
  {
    id: 201,
    question: "Theo quy m√¥/tr·ªØ l∆∞·ª£ng, t√†i nguy√™n ƒë∆∞·ª£c ph√¢n lo·∫°i th√†nh:",
    options: ["T√†i nguy√™n t√°i t·∫°o v√† kh√¥ng t√°i t·∫°o", "T√†i nguy√™n v√¥ h·∫°n v√† h·ªØu h·∫°n", "T√†i nguy√™n t·ª± nhi√™n v√† x√£ h·ªôi", "T√†i nguy√™n ƒë·∫•t v√† n∆∞·ªõc"],
    answer: "T√†i nguy√™n v√¥ h·∫°n v√† h·ªØu h·∫°n",
    chapter: 2,
    hint: "M·ªôt lo·∫°i d√πng m√£i kh√¥ng h·∫øt (n·∫Øng, gi√≥), m·ªôt lo·∫°i c√≥ gi·ªõi h·∫°n."
  },
  {
    id: 202,
    question: "T√†i nguy√™n n∆∞·ªõc l√† t√†i nguy√™n:",
    options: ["Kh√¥ng t√°i t·∫°o", "T√°i t·∫°o", "Vƒ©nh c·ª≠u", "T·∫•t c·∫£ ƒë·ªÅu sai"],
    answer: "T√°i t·∫°o",
    chapter: 2,
    hint: "N∆∞·ªõc c√≥ v√≤ng tu·∫ßn ho√†n t·ª± nhi√™n."
  },
  {
    id: 203,
    question: "C√¥ng th·ª©c I = P.C.T (t√°c ƒë·ªông m√¥i tr∆∞·ªùng) c·ªßa Ehrlich v√† Holdren. P l√† g√¨?",
    options: ["D√¢n s·ªë (Population)", "√î nhi·ªÖm (Pollution)", "S·∫£n xu·∫•t (Production)", "Ti√™u d√πng"],
    answer: "D√¢n s·ªë (Population)",
    chapter: 2,
    hint: "Ch·ªØ P ƒë·∫ßu ti√™n trong Population."
  },
  {
    id: 204,
    question: "Theo Lu·∫≠t ƒê·∫•t ƒëai 2013, nh√≥m ƒë·∫•t n√¥ng nghi·ªáp bao g·ªìm:",
    options: ["ƒê·∫•t ·ªü, ƒë·∫•t x√¢y d·ª±ng", "ƒê·∫•t tr·ªìng c√¢y l√¢u nƒÉm, ƒë·∫•t r·ª´ng s·∫£n xu·∫•t, ƒë·∫•t nu√¥i tr·ªìng th·ªßy s·∫£n", "ƒê·∫•t khu c√¥ng nghi·ªáp, ƒë·∫•t l√†m mu·ªëi", "ƒê·∫•t s√¥ng ng√≤i, k√™nh r·∫°ch"],
    answer: "ƒê·∫•t tr·ªìng c√¢y l√¢u nƒÉm, ƒë·∫•t r·ª´ng s·∫£n xu·∫•t, ƒë·∫•t nu√¥i tr·ªìng th·ªßy s·∫£n",
    chapter: 2,
    hint: "ƒê·∫•t d√πng ƒë·ªÉ s·∫£n xu·∫•t l∆∞∆°ng th·ª±c, th·ª±c ph·∫©m, tr·ªìng r·ª´ng."
  },
  {
    id: 205,
    question: "Ngh·ªã ƒë·ªãnh th∆∞ Montreal (1987) li√™n quan ƒë·∫øn v·∫•n ƒë·ªÅ g√¨?",
    options: ["C·∫Øt gi·∫£m kh√≠ nh√† k√≠nh", "C√°c ch·∫•t l√†m suy gi·∫£m t·∫ßng ozone", "B·∫£o v·ªá ƒë·ªông v·∫≠t hoang d√£", "√î nhi·ªÖm bi·ªÉn"],
    answer: "C√°c ch·∫•t l√†m suy gi·∫£m t·∫ßng ozone",
    chapter: 2,
    hint: "M·ª•c ti√™u l√† lo·∫°i b·ªè CFCs."
  },
  {
    id: 206,
    question: "C√¥ng ∆∞·ªõc RAMSAR (1971) li√™n quan ƒë·∫øn:",
    options: ["C√°c v√πng ƒë·∫•t ng·∫≠p n∆∞·ªõc", "Bu√¥n b√°n ƒë·ªông v·∫≠t hoang d√£", "Bi·∫øn ƒë·ªïi kh√≠ h·∫≠u", "Ch·∫•t th·∫£i nguy h·∫°i"],
    answer: "C√°c v√πng ƒë·∫•t ng·∫≠p n∆∞·ªõc",
    chapter: 2,
    hint: "B·∫£o v·ªá n∆°i c∆∞ tr√∫ c·ªßa c√°c lo√†i chim n∆∞·ªõc."
  },
  {
    id: 207,
    question: "CITES l√† t√™n vi·∫øt t·∫Øt c·ªßa c√¥ng ∆∞·ªõc v·ªÅ:",
    options: ["ƒêa d·∫°ng sinh h·ªçc", "Bu√¥n b√°n qu·ªëc t·∫ø c√°c lo√†i ƒë·ªông th·ª±c v·∫≠t hoang d√£ nguy c·∫•p", "Bi·∫øn ƒë·ªïi kh√≠ h·∫≠u", "Ch·∫•t th·∫£i r·∫Øn"],
    answer: "Bu√¥n b√°n qu·ªëc t·∫ø c√°c lo√†i ƒë·ªông th·ª±c v·∫≠t hoang d√£ nguy c·∫•p",
    chapter: 2,
    hint: "Ki·ªÉm so√°t vi·ªác mua b√°n ng√† voi, s·ª´ng t√™ gi√°c..."
  },
  {
    id: 208,
    question: "T√†i nguy√™n kho√°ng s·∫£n ƒë∆∞·ª£c chia th√†nh 3 nh√≥m:",
    options: ["NƒÉng l∆∞·ª£ng, Phi kim lo·∫°i, Kim lo·∫°i", "R·∫Øn, L·ªèng, Kh√≠", "T√°i t·∫°o, Kh√¥ng t√°i t·∫°o, Vƒ©nh c·ª≠u", "ƒê·∫•t, ƒê√°, Qu·∫∑ng"],
    answer: "NƒÉng l∆∞·ª£ng, Phi kim lo·∫°i, Kim lo·∫°i",
    chapter: 2,
    hint: "Than (nƒÉng l∆∞·ª£ng), S·∫Øt (kim lo·∫°i), ƒê√° v√¥i (phi kim)."
  },
  {
    id: 209,
    question: "D·∫°ng nƒÉng l∆∞·ª£ng n√†o sau ƒë√¢y l√† nƒÉng l∆∞·ª£ng t√°i t·∫°o?",
    options: ["Than ƒë√°", "D·∫ßu m·ªè", "Kh√≠ thi√™n nhi√™n", "NƒÉng l∆∞·ª£ng gi√≥, m·∫∑t tr·ªùi"],
    answer: "NƒÉng l∆∞·ª£ng gi√≥, m·∫∑t tr·ªùi",
    chapter: 2,
    hint: "NƒÉng l∆∞·ª£ng s·∫°ch, kh√¥ng c·∫°n ki·ªát."
  },
  {
    id: 210,
    question: "Vi·ªát Nam c√≥ 3 lo·∫°i r·ª´ng ch√≠nh l√†:",
    options: ["R·ª´ng ng·∫≠p m·∫∑n, r·ª´ng th∆∞a, r·ª´ng k√≠n", "R·ª´ng ƒë·∫∑c d·ª•ng, r·ª´ng ph√≤ng h·ªô, r·ª´ng s·∫£n xu·∫•t", "R·ª´ng nguy√™n sinh, r·ª´ng th·ª© sinh, r·ª´ng tr·ªìng", "R·ª´ng tr√™n c·∫°n, r·ª´ng d∆∞·ªõi n∆∞·ªõc, r·ª´ng tre n·ª©a"],
    answer: "R·ª´ng ƒë·∫∑c d·ª•ng, r·ª´ng ph√≤ng h·ªô, r·ª´ng s·∫£n xu·∫•t",
    chapter: 2,
    hint: "Ph√¢n lo·∫°i theo m·ª•c ƒë√≠ch s·ª≠ d·ª•ng trong Lu·∫≠t L√¢m nghi·ªáp."
  },

  // --- CH∆Ø∆†NG 3 ---
  {
    id: 301,
    question: "√î nhi·ªÖm m√¥i tr∆∞·ªùng l√† s·ª± bi·∫øn ƒë·ªïi c√°c th√†nh ph·∫ßn m√¥i tr∆∞·ªùng...?",
    options: ["Ph√π h·ª£p v·ªõi quy chu·∫©n k·ªπ thu·∫≠t", "Kh√¥ng ph√π h·ª£p (v∆∞·ª£t qu√°) quy chu·∫©n k·ªπ thu·∫≠t", "Do t·ª± nhi√™n g√¢y ra ho√†n to√†n", "Ch·ªâ ·∫£nh h∆∞·ªüng ƒë·∫øn kinh t·∫ø"],
    answer: "Kh√¥ng ph√π h·ª£p (v∆∞·ª£t qu√°) quy chu·∫©n k·ªπ thu·∫≠t",
    chapter: 3,
    hint: "Khi n·ªìng ƒë·ªô ch·∫•t ƒë·ªôc v∆∞·ª£t m·ª©c cho ph√©p."
  },
  {
    id: 302,
    question: "Ch·ªâ s·ªë BOD (Nhu c·∫ßu oxy sinh h√≥a) d√πng ƒë·ªÉ ƒë√°nh gi√° lo·∫°i √¥ nhi·ªÖm n√†o?",
    options: ["√î nhi·ªÖm kim lo·∫°i n·∫∑ng", "√î nhi·ªÖm h·ªØu c∆°", "√î nhi·ªÖm ph√≥ng x·∫°", "√î nhi·ªÖm nhi·ªát"],
    answer: "√î nhi·ªÖm h·ªØu c∆°",
    chapter: 3,
    hint: "Vi sinh v·∫≠t c·∫ßn Oxy ƒë·ªÉ ph√¢n h·ªßy ch·∫•t h·ªØu c∆°."
  },
  {
    id: 303,
    question: "Ngu·ªìn g·ªëc ph√°t sinh √¥ nhi·ªÖm kh√¥ng kh√≠ nh√¢n t·∫°o ch·ªß y·∫øu t·ª´:",
    options: ["N√∫i l·ª≠a phun tr√†o", "S·∫£n xu·∫•t c√¥ng nghi·ªáp v√† Giao th√¥ng v·∫≠n t·∫£i", "Ph√¢n h·ªßy x√°c ƒë·ªông v·∫≠t", "B√£o b·ª•i"],
    answer: "S·∫£n xu·∫•t c√¥ng nghi·ªáp v√† Giao th√¥ng v·∫≠n t·∫£i",
    chapter: 3,
    hint: "Kh√≥i t·ª´ nh√† m√°y v√† xe c·ªô."
  },
  {
    id: 304,
    question: "Hi·ªán t∆∞·ª£ng ph√∫ d∆∞·ª°ng trong n∆∞·ªõc th∆∞·ªùng do d∆∞ th·ª´a ch·∫•t g√¨?",
    options: ["Kim lo·∫°i n·∫∑ng (Hg, Pb)", "D·∫ßu m·ª°", "Ch·∫•t dinh d∆∞·ª°ng (N, P)", "Vi sinh v·∫≠t"],
    answer: "Ch·∫•t dinh d∆∞·ª°ng (N, P)",
    chapter: 3,
    hint: "Th·ª´a ƒë·∫°m (Nit∆°) v√† L√¢n (Photpho) l√†m t·∫£o n·ªü hoa."
  },
  {
    id: 305,
    question: "Bi·ªÉu hi·ªán nguy hi·ªÉm nh·∫•t c·ªßa suy tho√°i ƒë·∫•t l√†:",
    options: ["Nhi·ªÖm ph√®n", "Sa m·∫°c h√≥a", "Ng·∫≠p √∫ng", "Nhi·ªÖm m·∫∑n"],
    answer: "Sa m·∫°c h√≥a",
    chapter: 3,
    hint: "ƒê·∫•t ƒëai kh√¥ c·∫±n vƒ©nh vi·ªÖn, kh√¥ng th·ªÉ canh t√°c."
  },
  {
    id: 306,
    question: "Theo Lu·∫≠t BVMT 2020, c√≥ bao nhi√™u nh√≥m h√†nh vi b·ªã nghi√™m c·∫•m?",
    options: ["7 nh√≥m", "10 nh√≥m", "12 nh√≥m", "14 nh√≥m"],
    answer: "14 nh√≥m",
    chapter: 3,
    hint: "Con s·ªë l·ªõn nh·∫•t trong c√°c ƒë√°p √°n."
  },
  {
    id: 307,
    question: "E.coli v√† Coliform l√† th√¥ng s·ªë ƒë√°nh gi√° √¥ nhi·ªÖm d·∫°ng n√†o?",
    options: ["√î nhi·ªÖm h√≥a h·ªçc", "√î nhi·ªÖm v·∫≠t l√Ω", "√î nhi·ªÖm vi sinh", "√î nhi·ªÖm ph√≥ng x·∫°"],
    answer: "√î nhi·ªÖm vi sinh",
    chapter: 3,
    hint: "ƒê√¢y l√† t√™n c√°c lo·∫°i vi khu·∫©n g√¢y b·ªánh ƒë∆∞·ªùng ru·ªôt."
  },
  {
    id: 308,
    question: "Kh√≠ n√†o l√† nguy√™n nh√¢n ch√≠nh g√¢y ra m∆∞a axit?",
    options: ["CO v√† CO2", "SO2 v√† NOx", "CH4 v√† CFC", "O3 v√† Pb"],
    answer: "SO2 v√† NOx",
    chapter: 3,
    hint: "T·∫°o th√†nh Axit Sulfuric v√† Axit Nitric khi g·∫∑p n∆∞·ªõc."
  },
  {
    id: 309,
    question: "Nguy√™n nh√¢n g√¢y √¥ nhi·ªÖm ƒë·∫•t do ho·∫°t ƒë·ªông n√¥ng nghi·ªáp ch·ªß y·∫øu l√†:",
    options: ["S·ª≠ d·ª•ng ph√¢n b√≥n h√≥a h·ªçc v√† thu·ªëc BVTV qu√° m·ª©c", "Ch·∫•t th·∫£i c√¥ng nghi·ªáp", "R√°c th·∫£i sinh ho·∫°t", "Kh√≠ th·∫£i xe c·ªô"],
    answer: "S·ª≠ d·ª•ng ph√¢n b√≥n h√≥a h·ªçc v√† thu·ªëc BVTV qu√° m·ª©c",
    chapter: 3,
    hint: "H√≥a ch·∫•t do ng∆∞·ªùi n√¥ng d√¢n s·ª≠ d·ª•ng."
  },
  {
    id: 310,
    question: "C√¥ng th·ª©c h√≥a h·ªçc c·ªßa 'S√°t th·ªß v√¥ h√¨nh' g√¢y ng·∫°t kh√≠ l√†:",
    options: ["CO2", "CO", "SO2", "NO2"],
    answer: "CO",
    chapter: 3,
    hint: "Carbon Monoxide, kh√¥ng m√†u, kh√¥ng m√πi, r·∫•t ƒë·ªôc."
  },

  // --- CH∆Ø∆†NG 4 ---
  {
    id: 401,
    question: "IPCC l√† t√™n vi·∫øt t·∫Øt c·ªßa t·ªï ch·ª©c n√†o?",
    options: ["T·ªï ch·ª©c Y t·∫ø Th·∫ø gi·ªõi", "·ª¶y ban Li√™n ch√≠nh ph·ªß v·ªÅ Bi·∫øn ƒë·ªïi kh√≠ h·∫≠u", "T·ªï ch·ª©c Th∆∞∆°ng m·∫°i Th·∫ø gi·ªõi", "Ch∆∞∆°ng tr√¨nh M√¥i tr∆∞·ªùng LHQ"],
    answer: "·ª¶y ban Li√™n ch√≠nh ph·ªß v·ªÅ Bi·∫øn ƒë·ªïi kh√≠ h·∫≠u",
    chapter: 4,
    hint: "Panel on Climate Change."
  },
  {
    id: 402,
    question: "Bi·ªÉu hi·ªán ch√≠nh c·ªßa bi·∫øn ƒë·ªïi kh√≠ h·∫≠u to√†n c·∫ßu l√†:",
    options: ["ƒê·ªông ƒë·∫•t, s√≥ng th·∫ßn", "Nhi·ªát ƒë·ªô tƒÉng, m·ª±c n∆∞·ªõc bi·ªÉn d√¢ng, thay ƒë·ªïi l∆∞·ª£ng m∆∞a", "√î nhi·ªÖm kh√¥ng kh√≠ tƒÉng", "Suy gi·∫£m t·∫ßng ozone"],
    answer: "Nhi·ªát ƒë·ªô tƒÉng, m·ª±c n∆∞·ªõc bi·ªÉn d√¢ng, thay ƒë·ªïi l∆∞·ª£ng m∆∞a",
    chapter: 4,
    hint: "Tr√°i ƒë·∫•t n√≥ng l√™n l√†m bƒÉng tan."
  },
  {
    id: 403,
    question: "Kh√≠ nh√† k√≠nh (KNK) n√†o ƒë√≥ng g√≥p l·ªõn nh·∫•t v√†o hi·ªáu ·ª©ng nh√† k√≠nh nh√¢n t·∫°o?",
    options: ["CH4 (Metan)", "CO2 (Carbon dioxide)", "N2O (Nitrous oxide)", "CFCs"],
    answer: "CO2 (Carbon dioxide)",
    chapter: 4,
    hint: "Sinh ra t·ª´ vi·ªác ƒë·ªët than, xƒÉng d·∫ßu."
  },
  {
    id: 404,
    question: "Hai chi·∫øn l∆∞·ª£c ch√≠nh ƒë·ªÉ ·ª©ng ph√≥ v·ªõi BƒêKH l√†:",
    options: ["Ph√≤ng ng·ª´a v√† X·ª≠ l√Ω", "Th√≠ch ·ª©ng v√† Gi·∫£m nh·∫π", "Ch·ªëng ƒë·ªëi v√† Ch·∫•p nh·∫≠n", "T√°i t·∫°o v√† B·∫£o t·ªìn"],
    answer: "Th√≠ch ·ª©ng v√† Gi·∫£m nh·∫π",
    chapter: 4,
    hint: "Th√≠ch ·ª©ng ƒë·ªÉ s·ªëng chung, Gi·∫£m nh·∫π ƒë·ªÉ ngƒÉn ch·∫∑n nguy√™n nh√¢n."
  },
  {
    id: 405,
    question: "T·∫°i Vi·ªát Nam, hai khu v·ª±c b·ªã ·∫£nh h∆∞·ªüng n·∫∑ng nh·∫•t b·ªüi n∆∞·ªõc bi·ªÉn d√¢ng l√†:",
    options: ["T√¢y B·∫Øc v√† T√¢y Nguy√™n", "ƒê·ªìng b·∫±ng s√¥ng H·ªìng v√† ƒê·ªìng b·∫±ng s√¥ng C·ª≠u Long", "B·∫Øc Trung B·ªô v√† Nam Trung B·ªô", "H√† N·ªôi v√† TP.HCM"],
    answer: "ƒê·ªìng b·∫±ng s√¥ng H·ªìng v√† ƒê·ªìng b·∫±ng s√¥ng C·ª≠u Long",
    chapter: 4,
    hint: "Hai v·ª±a l√∫a l·ªõn, ƒë·ªãa h√¨nh th·∫•p tr≈©ng."
  },
  {
    id: 406,
    question: "Ho·∫°t ƒë·ªông 'Gi·∫£m nh·∫π' BƒêKH nh·∫Øm t·ªõi m·ª•c ti√™u g√¨?",
    options: ["Gi·∫£m thi·ªát h·∫°i do thi√™n tai", "Gi·∫£m ph√°t th·∫£i kh√≠ nh√† k√≠nh v√† tƒÉng b·ªÉ h·∫•p th·ª•", "Di d·ªùi d√¢n c∆∞", "X√¢y ƒë√™ bi·ªÉn"],
    answer: "Gi·∫£m ph√°t th·∫£i kh√≠ nh√† k√≠nh v√† tƒÉng b·ªÉ h·∫•p th·ª•",
    chapter: 4,
    hint: "Gi·∫£i quy·∫øt nguy√™n nh√¢n g·ªëc r·ªÖ (kh√≠ th·∫£i)."
  },
  {
    id: 407,
    question: "Kh√≠ CH4 (Metan) ph√°t sinh ch·ªß y·∫øu t·ª´ ho·∫°t ƒë·ªông n√†o?",
    options: ["Giao th√¥ng v·∫≠n t·∫£i", "Canh t√°c l√∫a n∆∞·ªõc, chƒÉn nu√¥i, b√£i r√°c", "S·∫£n xu·∫•t xi mƒÉng", "ƒê·ªët than ƒë√°"],
    answer: "Canh t√°c l√∫a n∆∞·ªõc, chƒÉn nu√¥i, b√£i r√°c",
    chapter: 4,
    hint: "Ph√¢n h·ªßy y·∫øm kh√≠ trong ru·ªông ng·∫≠p n∆∞·ªõc v√† d·∫° d√†y tr√¢u b√≤."
  },
  {
    id: 408,
    question: "K·ªãch b·∫£n BƒêKH trung b√¨nh cho Vi·ªát Nam d·ª±a tr√™n n·ªìng ƒë·ªô KNK n√†o?",
    options: ["RCP 2.6", "RCP 4.5 v√† RCP 6.0", "RCP 8.5", "RCP 10.0"],
    answer: "RCP 4.5 v√† RCP 6.0",
    chapter: 4,
    hint: "M·ª©c gi·ªØa (th·∫•p l√† 2.6, cao l√† 8.5)."
  },

  // --- CH∆Ø∆†NG 5 & 6 ---
  {
    id: 501,
    question: "Kh√°i ni·ªám Ph√°t tri·ªÉn b·ªÅn v·ªØng (PTBV) xu·∫•t hi·ªán n·ªïi b·∫≠t nh·∫•t trong b√°o c√°o n√†o?",
    options: ["T∆∞∆°ng lai c·ªßa ch√∫ng ta (Brundtland, 1987)", "Chi·∫øn l∆∞·ª£c b·∫£o t·ªìn th·∫ø gi·ªõi", "Ch∆∞∆°ng tr√¨nh ngh·ªã s·ª± 21", "C√¥ng ∆∞·ªõc Rio"],
    answer: "T∆∞∆°ng lai c·ªßa ch√∫ng ta (Brundtland, 1987)",
    chapter: 5,
    hint: "B√°o c√°o n·ªïi ti·∫øng c·ªßa b√† Brundtland."
  },
  {
    id: 502,
    question: "Ba tr·ª• c·ªôt c·ªßa ph√°t tri·ªÉn b·ªÅn v·ªØng l√†:",
    options: ["Kinh t·∫ø, Ch√≠nh tr·ªã, VƒÉn h√≥a", "Kinh t·∫ø, X√£ h·ªôi, M√¥i tr∆∞·ªùng", "T·ª± nhi√™n, Con ng∆∞·ªùi, X√£ h·ªôi", "Khoa h·ªçc, C√¥ng ngh·ªá, M√¥i tr∆∞·ªùng"],
    answer: "Kinh t·∫ø, X√£ h·ªôi, M√¥i tr∆∞·ªùng",
    chapter: 5,
    hint: "Tam gi√°c b·ªÅn v·ªØng."
  },
  {
    id: 503,
    question: "C√≥ bao nhi√™u M·ª•c ti√™u Ph√°t tri·ªÉn B·ªÅn v·ªØng (SDGs) c·ªßa LHQ ƒë·∫øn nƒÉm 2030?",
    options: ["10 m·ª•c ti√™u", "15 m·ª•c ti√™u", "17 m·ª•c ti√™u", "20 m·ª•c ti√™u"],
    answer: "17 m·ª•c ti√™u",
    chapter: 5,
    hint: "17 m·ª•c ti√™u v√† 169 ch·ªâ ti√™u."
  },
  {
    id: 601,
    question: "Nguy√™n t·∫Øc 'Ng∆∞·ªùi g√¢y √¥ nhi·ªÖm ph·∫£i tr·∫£ ti·ªÅn' (PPP) nghƒ©a l√†:",
    options: ["Ng∆∞·ªùi g√¢y √¥ nhi·ªÖm b·ªã ƒëi t√π", "Ng∆∞·ªùi g√¢y √¥ nhi·ªÖm ph·∫£i ch·ªãu chi ph√≠ cho c√°c bi·ªán ph√°p kh·∫Øc ph·ª•c v√† x·ª≠ l√Ω", "Nh√† n∆∞·ªõc tr·∫£ ti·ªÅn x·ª≠ l√Ω √¥ nhi·ªÖm", "C·ªông ƒë·ªìng quy√™n g√≥p ti·ªÅn x·ª≠ l√Ω"],
    answer: "Ng∆∞·ªùi g√¢y √¥ nhi·ªÖm ph·∫£i ch·ªãu chi ph√≠ cho c√°c bi·ªán ph√°p kh·∫Øc ph·ª•c v√† x·ª≠ l√Ω",
    chapter: 6,
    hint: "Ai l√†m b·∫©n th√¨ ng∆∞·ªùi ƒë√≥ ph·∫£i tr·∫£ ti·ªÅn d·ªçn d·∫πp."
  },
  {
    id: 602,
    question: "ISO 14000 l√† b·ªô ti√™u chu·∫©n qu·ªëc t·∫ø v·ªÅ:",
    options: ["Qu·∫£n l√Ω ch·∫•t l∆∞·ª£ng", "Qu·∫£n l√Ω m√¥i tr∆∞·ªùng", "An to√†n th·ª±c ph·∫©m", "An to√†n lao ƒë·ªông"],
    answer: "Qu·∫£n l√Ω m√¥i tr∆∞·ªùng",
    chapter: 6,
    hint: "D√†nh ri√™ng cho M√¥i tr∆∞·ªùng (Environment)."
  },
  {
    id: 603,
    question: "C√¥ng c·ª• kinh t·∫ø trong qu·∫£n l√Ω m√¥i tr∆∞·ªùng bao g·ªìm:",
    options: ["Lu·∫≠t, Ngh·ªã ƒë·ªãnh", "Thu·∫ø, ph√≠ m√¥i tr∆∞·ªùng, gi·∫•y ph√©p x·∫£ th·∫£i chuy·ªÉn nh∆∞·ª£ng", "Quan tr·∫Øc m√¥i tr∆∞·ªùng", "Gi√°o d·ª•c truy·ªÅn th√¥ng"],
    answer: "Thu·∫ø, ph√≠ m√¥i tr∆∞·ªùng, gi·∫•y ph√©p x·∫£ th·∫£i chuy·ªÉn nh∆∞·ª£ng",
    chapter: 6,
    hint: "Li√™n quan ƒë·∫øn t√†i ch√≠nh, ti·ªÅn t·ªá."
  },
  {
    id: 604,
    question: "ƒêTM (ƒê√°nh gi√° t√°c ƒë·ªông m√¥i tr∆∞·ªùng) th∆∞·ªùng ƒë∆∞·ª£c th·ª±c hi·ªán khi n√†o?",
    options: ["Sau khi d·ª± √°n ho·∫°t ƒë·ªông", "Tr∆∞·ªõc khi ph√™ duy·ªát d·ª± √°n", "Khi c√≥ s·ª± c·ªë", "Khi d·ª± √°n gi·∫£i th·ªÉ"],
    answer: "Tr∆∞·ªõc khi ph√™ duy·ªát d·ª± √°n",
    chapter: 6,
    hint: "Mang t√≠nh ph√≤ng ng·ª´a, ph·∫£i l√†m tr∆∞·ªõc."
  },
  {
    id: 605,
    question: "Qu·∫£n l√Ω m√¥i tr∆∞·ªùng c·∫ßn tu√¢n th·ªß nguy√™n t·∫Øc n√†o?",
    options: ["Qu·∫£n l√Ω theo s·ª± v·ª•", "Qu·∫£n l√Ω t·ªïng h·ª£p v√† th·ªëng nh·∫•t", "∆Øu ti√™n x·ª≠ l√Ω sau khi √¥ nhi·ªÖm", "Kinh t·∫ø tr∆∞·ªõc, m√¥i tr∆∞·ªùng sau"],
    answer: "Qu·∫£n l√Ω t·ªïng h·ª£p v√† th·ªëng nh·∫•t",
    chapter: 6,
    hint: "Kh√¥ng qu·∫£n l√Ω r·ªùi r·∫°c, c·∫Øt kh√∫c."
  },
  {
    id: 606,
    question: "C√¥ng ∆∞·ªõc Basel (1989) ki·ªÉm so√°t v·∫•n ƒë·ªÅ g√¨?",
    options: ["V·∫≠n chuy·ªÉn ch·∫•t th·∫£i nguy h·∫°i qua bi√™n gi·ªõi", "B·∫£o v·ªá t·∫ßng Ozone", "Bi·∫øn ƒë·ªïi kh√≠ h·∫≠u", "Bu√¥n b√°n ƒë·ªông v·∫≠t hoang d√£"],
    answer: "V·∫≠n chuy·ªÉn ch·∫•t th·∫£i nguy h·∫°i qua bi√™n gi·ªõi",
    chapter: 6,
    hint: "NgƒÉn ch·∫∑n c√°c n∆∞·ªõc gi√†u ƒë·ªï r√°c ƒë·ªôc h·∫°i sang n∆∞·ªõc ngh√®o."
  }
];

// --- LOGIC TR·ªòN M·∫¢NG ---
const shuffleArray = (array) => {
  const newArray = [...array];
  for (let i = newArray.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [newArray[i], newArray[j]] = [newArray[j], newArray[i]];
  }
  return newArray;
};

// --- COMPONENTS ---

const Header = ({ setView }) => (
  <header className="bg-gradient-to-r from-teal-700 to-emerald-600 text-white p-4 shadow-lg sticky top-0 z-50">
    <div className="container mx-auto flex justify-between items-center">
      <h1 className="text-xl md:text-2xl font-bold flex items-center gap-2 cursor-pointer" onClick={() => setView('home')}>
        <BookOpen size={28} />
        √în t·∫≠p MTƒêC
      </h1>
      <nav className="flex gap-4">
        <button onClick={() => setView('home')} className="hover:bg-white/20 px-3 py-1 rounded-full transition-all text-sm font-semibold">Trang ch·ªß</button>
      </nav>
    </div>
  </header>
);

const HomeView = ({ startQuiz }) => (
  <div className="flex flex-col items-center justify-center py-16 px-4 text-center">
    <div className="bg-white p-10 rounded-3xl shadow-2xl max-w-lg w-full border border-teal-50 relative overflow-hidden">
      <div className="absolute top-0 left-0 w-full h-3 bg-gradient-to-r from-teal-400 to-emerald-500"></div>
      
      <h2 className="text-3xl font-extrabold text-teal-800 mb-4">Tr·∫Øc Nghi·ªám M√¥i Tr∆∞·ªùng</h2>
      <p className="text-gray-600 mb-10 text-lg">
        H·ªá th·ªëng √¥n t·∫≠p ki·∫øn th·ª©c t·ª´ Ch∆∞∆°ng 1 ƒë·∫øn Ch∆∞∆°ng 6. <br/>
        S·∫µn s√†ng th·ª≠ th√°ch b·∫£n th√¢n ch∆∞a?
      </p>
      
      <div className="flex justify-center">
        <button 
          onClick={() => startQuiz(30)}
          className="group relative w-full py-5 bg-gradient-to-r from-teal-500 to-emerald-600 text-white rounded-2xl shadow-xl hover:shadow-2xl hover:scale-[1.02] transition-all duration-300 ring-4 ring-transparent hover:ring-teal-200"
        >
          <div className="flex items-center justify-center gap-3">
             <div className="bg-white/20 p-2 rounded-full group-hover:bg-white/30 transition-colors">
                <Play size={32} fill="currentColor" />
             </div>
             <div className="text-left">
                <span className="block font-bold text-2xl leading-none">B·∫ÆT ƒê·∫¶U L√ÄM B√ÄI</span>
                <span className="text-sm opacity-90 font-light">ƒê·ªÅ ng·∫´u nhi√™n 30 c√¢u</span>
             </div>
          </div>
        </button>
      </div>
      
      <div className="mt-8 flex justify-center gap-6 text-gray-400 text-sm">
         <div className="flex items-center gap-1"><RefreshCw size={14}/> X√°o tr·ªôn</div>
         <div className="flex items-center gap-1"><Lightbulb size={14}/> G·ª£i √Ω</div>
         <div className="flex items-center gap-1"><Award size={14}/> ƒêi·ªÉm th∆∞·ªüng</div>
      </div>
    </div>
  </div>
);

const QuizRunView = ({ questions, finishQuiz }) => {
  const [currentQIdx, setCurrentQIdx] = useState(0);
  const [userAnswers, setUserAnswers] = useState({});
  const [showConfirmSubmit, setShowConfirmSubmit] = useState(false);
  const [showHint, setShowHint] = useState(false);

  useEffect(() => {
    setShowHint(false);
  }, [currentQIdx]);

  const handleSelect = (option) => {
    setUserAnswers(prev => ({
      ...prev,
      [questions[currentQIdx].id]: option
    }));
  };

  const progress = ((Object.keys(userAnswers).length) / questions.length) * 100;

  const handleSubmit = () => {
    finishQuiz(userAnswers, questions);
  };

  const currentQ = questions[currentQIdx];

  return (
    <div className="container mx-auto py-8 px-4 max-w-3xl">
      <div className="mb-6 bg-white p-4 rounded-2xl shadow-sm border border-gray-100">
        <div className="flex justify-between text-sm text-gray-600 mb-2 font-bold">
          <span className="text-teal-700">C√¢u {currentQIdx + 1}/{questions.length}</span>
          <span>ƒê√£ l√†m: {Object.keys(userAnswers).length}</span>
        </div>
        <div className="w-full bg-gray-100 rounded-full h-3 overflow-hidden">
          <div className="bg-teal-500 h-3 rounded-full transition-all duration-500 ease-out" style={{ width: `${progress}%` }}></div>
        </div>
      </div>

      <div className="bg-white p-6 md:p-8 rounded-2xl shadow-xl border border-white min-h-[450px] flex flex-col relative transition-all">
        <div className="mb-6">
          <div className="flex justify-between items-start mb-4">
             <span className="inline-block px-3 py-1 bg-teal-50 text-teal-700 text-xs rounded-lg font-bold uppercase tracking-wider border border-teal-100">
                Ch∆∞∆°ng {currentQ.chapter}
            </span>
            
            <button 
                onClick={() => setShowHint(!showHint)}
                className={`flex items-center gap-1 font-medium text-sm px-3 py-1 rounded-full transition-colors ${showHint ? 'bg-amber-100 text-amber-700' : 'text-gray-400 hover:text-amber-500 hover:bg-gray-50'}`}
            >
                <Lightbulb size={18} className={showHint ? "fill-amber-500 text-amber-500" : ""} />
                {showHint ? "ƒêang hi·ªán g·ª£i √Ω" : "G·ª£i √Ω"}
            </button>
          </div>
          
          {showHint && (
            <div className="mb-5 p-4 bg-amber-50 border-l-4 border-amber-400 rounded-r-lg text-amber-800 text-sm animate-fadeIn">
                <strong className="block mb-1 text-amber-600 uppercase text-xs tracking-wider">G·ª£i √Ω cho b·∫°n:</strong>
                {currentQ.hint}
            </div>
          )}

          <h3 className="text-xl md:text-2xl font-bold text-gray-800 leading-snug">
            {currentQ.question}
          </h3>
        </div>

        <div className="space-y-3 flex-grow">
          {currentQ.options.map((opt, idx) => {
            const isSelected = userAnswers[currentQ.id] === opt;
            return (
              <button
                key={idx}
                onClick={() => handleSelect(opt)}
                className={`w-full text-left p-4 rounded-xl border-2 transition-all duration-200 flex items-center justify-between group ${
                  isSelected 
                  ? 'border-teal-500 bg-teal-50 text-teal-900 font-medium shadow-md' 
                  : 'border-gray-100 hover:border-teal-200 hover:bg-gray-50 text-gray-700'
                }`}
              >
                <span className="flex-grow">{opt}</span>
                {isSelected ? <div className="bg-teal-500 text-white rounded-full p-1"><CheckCircle size={16} /></div> : <div className="w-6 h-6 rounded-full border-2 border-gray-200 group-hover:border-teal-300"></div>}
              </button>
            )
          })}
        </div>

        <div className="mt-8 flex justify-between items-center pt-6 border-t border-gray-50">
          <button 
            disabled={currentQIdx === 0}
            onClick={() => setCurrentQIdx(prev => prev - 1)}
            className={`px-5 py-2 rounded-xl font-bold transition-colors ${currentQIdx === 0 ? 'text-gray-300 cursor-not-allowed' : 'text-gray-500 hover:bg-gray-100'}`}
          >
            Quay l·∫°i
          </button>

          {currentQIdx < questions.length - 1 ? (
            <button 
              onClick={() => setCurrentQIdx(prev => prev + 1)}
              className="px-6 py-3 bg-teal-600 text-white rounded-xl hover:bg-teal-700 font-bold flex items-center shadow-lg hover:shadow-teal-200"
            >
              C√¢u ti·∫øp <ChevronRight size={20} className="ml-1" />
            </button>
          ) : (
            <button 
              onClick={() => setShowConfirmSubmit(true)}
              className="px-8 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 font-bold shadow-lg hover:shadow-blue-200 flex items-center gap-2"
            >
              <CheckCircle size={20} /> N·ªôp b√†i
            </button>
          )}
        </div>
      </div>

      {showConfirmSubmit && (
        <div className="fixed inset-0 bg-teal-900/40 backdrop-blur-sm flex items-center justify-center z-50 px-4 animate-fadeIn">
          <div className="bg-white rounded-3xl p-8 max-w-sm w-full shadow-2xl transform scale-100">
            <h3 className="text-2xl font-bold mb-3 text-gray-800 text-center">N·ªôp b√†i ngay?</h3>
            <p className="text-gray-500 mb-8 text-center">
              B·∫°n ƒë√£ ho√†n th√†nh <span className="font-bold text-teal-600 text-lg">{Object.keys(userAnswers).length}</span>/<span className="font-bold text-lg">{questions.length}</span> c√¢u.
            </p>
            <div className="flex flex-col gap-3">
              <button 
                onClick={handleSubmit}
                className="w-full py-3 bg-teal-600 text-white rounded-xl hover:bg-teal-700 font-bold text-lg shadow-lg"
              >
                N·ªôp b√†i
              </button>
              <button 
                onClick={() => setShowConfirmSubmit(false)}
                className="w-full py-3 text-gray-500 hover:bg-gray-100 rounded-xl font-bold"
              >
                Xem l·∫°i
              </button>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

const QuizResultView = ({ result, setView, restartQuiz }) => {
  const { score, total, userAnswers, questions } = result;
  const percentage = Math.round((score / total) * 100);
  const [showReward, setShowReward] = useState(false);

  useEffect(() => {
    if (score > 25) {
      setTimeout(() => setShowReward(true), 500);
    }
  }, [score]);

  return (
    <div className="container mx-auto py-8 px-4 max-w-4xl relative">
      {/* POPUP KHEN TH∆Ø·ªûNG */}
      {showReward && (
        <div className="fixed inset-0 bg-black/60 flex items-center justify-center z-[60] px-4 backdrop-blur-md animate-fadeIn">
           <div className="bg-white rounded-[2rem] p-8 max-w-md w-full shadow-2xl text-center relative overflow-hidden animate-bounceIn border-4 border-pink-200">
              <div className="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-pink-400 to-red-500"></div>
              <div className="flex justify-center mb-6 mt-2">
                 <div className="bg-pink-50 p-6 rounded-full shadow-inner">
                    <Heart size={64} className="text-pink-500 fill-pink-500 animate-pulse" />
                 </div>
              </div>
              <h2 className="text-3xl font-extrabold text-gray-800 mb-2">Tuy·ªát v·ªùi!</h2>
              <p className="text-2xl text-pink-600 font-bold mb-6">Em gi·ªèi l·∫Øm, y√™u em ‚ù§Ô∏è</p>
              <p className="text-gray-500 mb-8 font-medium">B·∫°n ƒë·∫°t {score}/{total} ƒëi·ªÉm. Qu√° xu·∫•t s·∫Øc!</p>
              
              <button 
                onClick={() => setShowReward(false)}
                className="w-full py-3.5 bg-gradient-to-r from-pink-500 to-rose-500 text-white rounded-2xl font-bold hover:shadow-lg hover:scale-[1.02] transition-all"
              >
                Nh·∫≠n l·ªùi khen ü•∞
              </button>
           </div>
        </div>
      )}

      <div className="bg-white rounded-3xl shadow-xl overflow-hidden mb-8 border border-gray-100">
        <div className={`p-10 text-center text-white relative ${score > 25 ? 'bg-gradient-to-br from-pink-500 to-rose-500' : 'bg-gradient-to-br from-teal-600 to-emerald-600'}`}>
          <div className="absolute top-4 right-4 opacity-20"><Award size={120}/></div>
          <h2 className="text-2xl font-bold mb-2 opacity-90">K·∫øt Qu·∫£ B√†i L√†m</h2>
          <div className="text-8xl font-black my-4 tracking-tighter drop-shadow-lg">{score}<span className="text-4xl opacity-60 font-medium">/{total}</span></div>
          <p className="text-white/90 text-lg font-medium bg-white/20 inline-block px-4 py-1 rounded-full">{percentage}% ƒëi·ªÉm s·ªë</p>
        </div>
        
        <div className="p-6 flex flex-col sm:flex-row justify-center gap-4 bg-gray-50 border-t border-gray-100">
            <button 
                onClick={restartQuiz} 
                className="flex items-center justify-center gap-2 px-8 py-3 bg-white border-2 border-teal-600 text-teal-700 rounded-xl hover:bg-teal-50 font-bold shadow-sm hover:shadow-md transition-all"
            >
                <RefreshCw size={20} /> L√†m ƒë·ªÅ m·ªõi (X√°o tr·ªôn)
            </button>
            <button 
                onClick={() => setView('home')} 
                className="flex items-center justify-center gap-2 px-8 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 font-bold shadow-sm hover:shadow-md transition-all"
            >
                <Home size={20} /> V·ªÅ trang ch·ªß
            </button>
        </div>
      </div>

      <div className="space-y-6">
        {questions.map((q, idx) => {
          const uAns = userAnswers[q.id];
          const isCorrect = uAns === q.answer;

          return (
            <div key={q.id} className={`p-6 rounded-2xl border-l-4 shadow-sm bg-white ${isCorrect ? 'border-teal-500' : 'border-red-500'}`}>
              <div className="flex gap-4">
                <span className={`flex-shrink-0 w-10 h-10 flex items-center justify-center rounded-full font-bold text-base ${isCorrect ? 'bg-teal-100 text-teal-700' : 'bg-red-100 text-red-700'}`}>
                  {idx + 1}
                </span>
                <div className="flex-grow">
                  <p className="font-bold text-gray-800 text-lg mb-4 leading-relaxed">{q.question}</p>
                  
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-3">
                    {q.options.map((opt, oIdx) => {
                      let optionClass = "p-3 rounded-lg border text-sm transition-all flex justify-between items-center ";
                      if (opt === q.answer) {
                        optionClass += "bg-teal-50 border-teal-500 text-teal-900 font-bold ring-1 ring-teal-500"; 
                      } else if (opt === uAns && !isCorrect) {
                        optionClass += "bg-red-50 border-red-400 text-red-900 font-medium";
                      } else {
                        optionClass += "bg-white border-gray-200 text-gray-400";
                      }

                      return (
                        <div key={oIdx} className={optionClass}>
                            <span>{opt}</span>
                            {opt === q.answer && <CheckCircle size={18} className="text-teal-600 flex-shrink-0 ml-2" />}
                            {opt === uAns && !isCorrect && <AlertTriangle size={18} className="text-red-500 flex-shrink-0 ml-2" />}
                        </div>
                      )
                    })}
                  </div>
                  
                  {!isCorrect && (
                    <div className="mt-4 text-sm bg-red-50 border border-red-100 p-4 rounded-xl text-gray-700">
                      <div className="flex items-center gap-2 mb-1">
                        <AlertTriangle size={16} className="text-red-500"/>
                        <span className="text-red-600 font-bold">ƒê√°p √°n ƒë√∫ng:</span>
                      </div>
                      <div className="text-teal-700 font-bold text-base mb-2">{q.answer}</div>
                      <div className="text-gray-500 italic text-xs bg-white p-2 rounded border border-red-100">Gi·∫£i th√≠ch: {q.hint}</div>
                    </div>
                  )}
                </div>
              </div>
            </div>
          );
        })}
      </div>
    </div>
  );
};

// --- MAIN APP COMPONENT ---

export default function App() {
  const [view, setView] = useState('home'); 
  const [quizQuestions, setQuizQuestions] = useState([]);
  const [quizResult, setQuizResult] = useState(null);

  const startQuiz = (limit = 30) => {
    // X√°o tr·ªôn v√† l·∫•y 30 c√¢u
    const shuffled = shuffleArray([...fullQuestionBank]);
    const selected = shuffled.slice(0, limit);
    setQuizQuestions(selected);
    setView('quiz_run');
  };

  const finishQuiz = (userAnswers, questions) => {
    let score = 0;
    questions.forEach(q => {
      if (userAnswers[q.id] === q.answer) {
        score++;
      }
    });

    setQuizResult({
      score,
      total: questions.length,
      userAnswers,
      questions
    });
    setView('quiz_result');
  };

  return (
    <div className="min-h-screen bg-slate-50 flex flex-col font-sans text-gray-800">
      <Header setView={setView} />
      
      <main className="flex-grow">
        {view === 'home' && <HomeView startQuiz={startQuiz} />}
        {view === 'quiz_run' && <QuizRunView questions={quizQuestions} finishQuiz={finishQuiz} />}
        {view === 'quiz_result' && <QuizResultView result={quizResult} setView={setView} restartQuiz={() => startQuiz(30)} />}
      </main>
      
      <footer className="bg-white text-gray-400 py-6 text-center text-xs border-t">
        ¬© 2024 ·ª®ng d·ª•ng √¥n t·∫≠p MTƒêC.
      </footer>
    </div>
  );
}